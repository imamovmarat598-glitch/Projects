# GeoMark ‚Äî –ü–æ–ª–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
## GPS Camera App —Å –≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π

**–î–∞—Ç–∞:** 15 —è–Ω–≤–∞—Ä—è 2026
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** Ready for Development

---

## üìä –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ (2026)

### –¢–æ–ø –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –∏ –∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

#### 1. **NoteCam Lite** (620K —Å–∫–∞—á–∏–≤–∞–Ω–∏–π/–º–µ—Å—è—Ü)
- ‚úÖ GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã + timestamp –Ω–∞ —Ñ–æ—Ç–æ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–∞/—à—Ä–∏—Ñ—Ç–∞ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞
- ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ 16:9 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ watermark –≤ Pro –≤–µ—Ä—Å–∏–∏
- ‚ùå –ù–µ—Ç web –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- ‚ùå –ù–µ—Ç –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –¥–∏–∑–∞–π–Ω

#### 2. **Timestamp Camera** (1.3M —Å–∫–∞—á–∏–≤–∞–Ω–∏–π/–º–µ—Å—è—Ü, 4.63‚òÖ)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è (–∞–¥—Ä–µ—Å, –≤—ã—Å–æ—Ç–∞, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
- ‚úÖ –ü–æ–≥–æ–¥–∞ –Ω–∞ —Ñ–æ—Ç–æ
- ‚úÖ –ö–æ–º–ø–∞—Å
- ‚ùå –ü–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚ùå –ú–Ω–æ–≥–æ —Ä–µ–∫–ª–∞–º—ã

#### 3. **GPS Map Camera**
- ‚úÖ –ö–∞—Ä—Ç–∞ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏
- ‚úÖ –ê–¥—Ä–µ—Å —á–µ—Ä–µ–∑ geocoding
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- ‚ùå –ù–µ—Ç –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Å—ã–ª–æ–∫

### üéØ –ù–∞—à–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–í–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ —Å–∞–π—Ç (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã —ç—Ç–æ–≥–æ –Ω–µ –∏–º–µ—é—Ç!)
2. **–ü—É–±–ª–∏—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏** ‚Äî –¥–µ–ª–∏—Ç—å—Å—è —Ñ–æ—Ç–æ —Å –∫–∞—Ä—Ç–æ–π —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫—É—é —Å—Å—ã–ª–∫—É
3. **Material Design 3** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å Material You
4. **Location pattern detection** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
5. **Metadata retention** ‚Äî —É–º–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
6. **PWA** ‚Äî —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
7. **–ë–∞—Ç–∞—Ä–µ—è** ‚Äî AI-powered GPS tracking (–Ω–∞ 80% –º–µ–Ω—å—à–µ —Ä–∞—Å—Ö–æ–¥)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π –Ω–∞ 2026):

#### **Mobile App (React Native 0.74+)**
```
React Native 0.74 (New Architecture: Fabric + TurboModules)
‚îú‚îÄ‚îÄ Camera: react-native-vision-camera 4.x (—Å GPS Location Tags)
‚îú‚îÄ‚îÄ GPS: @react-native-community/geolocation + motion detection
‚îú‚îÄ‚îÄ Maps: react-native-maps (Google Maps / Mapbox)
‚îú‚îÄ‚îÄ Storage: WatermelonDB (–¥–ª—è –æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞)
‚îú‚îÄ‚îÄ UI: React Native Paper (Material Design 3)
‚îú‚îÄ‚îÄ Navigation: React Navigation 7.x
‚îú‚îÄ‚îÄ State: Zustand + TanStack Query
‚îî‚îÄ‚îÄ Build: EAS Build (Expo Application Services)
```

**–ë–∞—Ç–∞—Ä–µ—è:** Intelligent motion detection ‚Äî GPS –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ (80% —ç–∫–æ–Ω–æ–º–∏—è)

#### **Website (Next.js 15+)**
```
Next.js 15 (App Router + Server Components)
‚îú‚îÄ‚îÄ UI: shadcn/ui + Tailwind CSS 4.0
‚îú‚îÄ‚îÄ Maps: Mapbox GL JS / Leaflet
‚îú‚îÄ‚îÄ Upload: react-dropzone + exifr (EXIF extraction)
‚îú‚îÄ‚îÄ Camera: getUserMedia API (WebRTC)
‚îú‚îÄ‚îÄ PWA: next-pwa (–æ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º)
‚îú‚îÄ‚îÄ Forms: React Hook Form + Zod
‚îî‚îÄ‚îÄ Deployment: Vercel / Cloudflare Pages
```

#### **Backend API (NestJS 11+)**
```
NestJS 11 (Node.js 20 LTS)
‚îú‚îÄ‚îÄ Database: PostgreSQL 16 + PostGIS 3.4
‚îú‚îÄ‚îÄ Storage: Cloudflare R2
‚îú‚îÄ‚îÄ Cache: Redis 7.x
‚îú‚îÄ‚îÄ Queue: Bull MQ (–¥–ª—è Telegram –æ—Ç–ø—Ä–∞–≤–∫–∏)
‚îú‚îÄ‚îÄ Geocoding: Nominatim (OpenStreetMap) + Google Maps API fallback
‚îú‚îÄ‚îÄ Thumbnails: Sharp (server-side image processing)
‚îú‚îÄ‚îÄ Auth: Device fingerprinting + IP-based rate limiting
‚îî‚îÄ‚îÄ Monitoring: Sentry + Datadog
```

#### **Telegram Bot**
```
node-telegram-bot-api
‚îú‚îÄ‚îÄ –†–æ—É—Ç–∏–Ω–≥ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (PostGIS spatial queries)
‚îú‚îÄ‚îÄ Location pattern detection
‚îú‚îÄ‚îÄ Thumbnail –æ—Ç–ø—Ä–∞–≤–∫–∞ (–Ω–µ 10MB)
‚îî‚îÄ‚îÄ Bot commands –¥–ª—è –ø–æ–∏—Å–∫–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞
```

---

## üé® –î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ GeoMark

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã 2026:

1. **Material You / Dynamic Theming**
   - –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ wallpaper –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Android 12+)
   - –°–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è —Ç–µ–º–∞ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞–∫—Ü–µ–Ω—Ç—ã

2. **Spatial UI & Depth**
   - Subtle 3D-like UI depth
   - Layered design –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏
   - Elevation shadows

3. **Motion UI**
   - Micro-interactions –¥–ª—è feedback
   - Smooth transitions –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
   - Loading animations

4. **3D Elements (–¥–ª—è –∫–∞—Ä—Ç—ã)**
   - 3D –º–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ
   - Elevation visualization
   - AR preview (Phase 2)

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:

```css
/* Primary (Blue-Green) */
--primary: #00796B (Teal 700)
--primary-variant: #004D40

/* Secondary (Amber) */
--secondary: #FFA000 (Amber 700)
--secondary-variant: #FF6F00

/* Background */
--bg-light: #FAFAFA
--bg-dark: #121212

/* Surface */
--surface-light: #FFFFFF
--surface-dark: #1E1E1E

/* Error/Warning */
--error: #D32F2F
--warning: #F57C00
--success: #388E3C
```

### –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è:

```css
/* Material Design 3 Typography Scale */
Font Family: Roboto (Android), SF Pro (iOS), Inter (Web)

Display Large: 57sp / Regular
Display Medium: 45sp / Regular
Display Small: 36sp / Regular

Headline Large: 32sp / Regular
Headline Medium: 28sp / Regular
Headline Small: 24sp / Regular

Title Large: 22sp / Medium
Title Medium: 16sp / Medium
Title Small: 14sp / Medium

Body Large: 16sp / Regular
Body Medium: 14sp / Regular
Body Small: 12sp / Regular
```

### UI Components:

1. **Camera Screen**
   - Live preview (full screen)
   - GPS accuracy indicator (–∑–µ–ª—ë–Ω—ã–π/–∂—ë–ª—Ç—ã–π/–∫—Ä–∞—Å–Ω—ã–π)
   - Capture button (Material FAB)
   - Settings overlay (translucent)
   - Watermark preview (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)

2. **Map Screen**
   - Interactive map (Mapbox 3D terrain)
   - Photo markers (clustered)
   - Filter chips (Material 3)
   - Bottom sheet —Å —Ñ–æ—Ç–æ
   - Search bar —Å autocomplete

3. **Gallery Screen**
   - Grid layout (3 columns)
   - Thumbnail previews
   - Infinite scroll
   - Selection mode (multi-select)
   - Filter/sort toolbar

4. **Photo Detail Screen**
   - Hero image transition
   - Metadata cards (collapsible)
   - Mini map
   - Share button
   - Edit/Delete actions

5. **Settings Screen**
   - Grouped list items
   - Material switches/sliders
   - Auto-deletion timer picker
   - Theme selector
   - Privacy Policy link

---

## üì± Mobile App ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### Screens —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
App Navigation (Bottom Tabs)
‚îú‚îÄ‚îÄ Camera (Main)
‚îÇ   ‚îú‚îÄ‚îÄ Capture Screen
‚îÇ   ‚îú‚îÄ‚îÄ Settings Overlay
‚îÇ   ‚îî‚îÄ‚îÄ Watermark Preview
‚îú‚îÄ‚îÄ Gallery
‚îÇ   ‚îú‚îÄ‚îÄ Grid View
‚îÇ   ‚îú‚îÄ‚îÄ Photo Detail
‚îÇ   ‚îî‚îÄ‚îÄ Selection Mode
‚îú‚îÄ‚îÄ Map
‚îÇ   ‚îú‚îÄ‚îÄ Markers View
‚îÇ   ‚îú‚îÄ‚îÄ Cluster Expand
‚îÇ   ‚îî‚îÄ‚îÄ Photo Preview (Bottom Sheet)
‚îî‚îÄ‚îÄ Settings
    ‚îú‚îÄ‚îÄ Profile (–∞–Ω–æ–Ω–∏–º–Ω—ã–π)
    ‚îú‚îÄ‚îÄ Auto-Delete Settings
    ‚îú‚îÄ‚îÄ Camera Settings
    ‚îú‚îÄ‚îÄ Privacy Policy
    ‚îî‚îÄ‚îÄ About
```

### Camera Implementation (VisionCamera 4.x):

```typescript
import { Camera, useCameraDevice } from 'react-native-vision-camera';
import Geolocation from '@react-native-community/geolocation';

const CameraScreen = () => {
  const device = useCameraDevice('back');

  // Intelligent GPS tracking (motion detection)
  useMotionDetection({
    onMoving: () => startHighAccuracyGPS(),
    onStationary: () => startLowPowerGPS(),
  });

  const takePhoto = async () => {
    const photo = await camera.current.takePhoto({
      enableLocation: true, // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç GPS EXIF tags
      qualityPrioritization: 'balanced',
    });

    // Generate thumbnail client-side
    const thumbnail = await generateThumbnail(photo.path, {
      maxWidth: 640,
      maxHeight: 480,
    });

    // Add custom watermark with GPS data
    const watermarked = await addWatermark(photo.path, {
      latitude: gps.latitude,
      longitude: gps.longitude,
      accuracy: gps.accuracy,
      timestamp: new Date(),
      address: await geocodeLocation(gps), // Cached geocoding
    });

    // Save locally
    await saveToGallery(watermarked);

    // Upload to server (with offline queue)
    await uploadPhoto(watermarked, thumbnail, metadata);
  };
};
```

### GPS Optimization (Battery Efficient):

```typescript
// AI-powered motion detection
const useMotionDetection = ({ onMoving, onStationary }) => {
  useEffect(() => {
    const subscription = accelerometer.subscribe(({ x, y, z }) => {
      const magnitude = Math.sqrt(x*x + y*y + z*z);

      if (magnitude > MOTION_THRESHOLD) {
        onMoving(); // High-accuracy GPS
      } else {
        onStationary(); // Low-power GPS
      }
    });

    return () => subscription.unsubscribe();
  }, []);
};
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞—Å—Ö–æ–¥ –±–∞—Ç–∞—Ä–µ–∏ 1-2% –∑–∞ 24 —á–∞—Å–∞ (vs 10-15% —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤)

### Offline Mode (WatermelonDB):

```typescript
// Schema
const photoSchema = {
  name: 'photos',
  columns: [
    { name: 'path', type: 'string' },
    { name: 'latitude', type: 'number' },
    { name: 'longitude', type: 'number' },
    { name: 'timestamp', type: 'number' },
    { name: 'uploaded', type: 'boolean' },
    { name: 'upload_queue', type: 'boolean' },
  ],
};

// Offline queue
const uploadQueue = async () => {
  const pending = await database.collections
    .get('photos')
    .query(Q.where('upload_queue', true))
    .fetch();

  for (const photo of pending) {
    try {
      await uploadPhoto(photo);
      await photo.update(p => {
        p.uploaded = true;
        p.upload_queue = false;
      });
    } catch (error) {
      // Retry later
    }
  }
};
```

### Material Design 3 Implementation:

```typescript
import { MD3LightTheme, MD3DarkTheme, PaperProvider } from 'react-native-paper';

const theme = {
  ...MD3LightTheme,
  colors: {
    ...MD3LightTheme.colors,
    primary: '#00796B',
    secondary: '#FFA000',
    // Material You dynamic colors (Android 12+)
    ...DynamicColorPalette,
  },
  roundness: 12,
};

const App = () => (
  <PaperProvider theme={theme}>
    <NavigationContainer>
      {/* App content */}
    </NavigationContainer>
  </PaperProvider>
);
```

---

## üåê Website ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### Pages —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
Website (Next.js 15 App Router)
‚îú‚îÄ‚îÄ / (Landing Page)
‚îÇ   ‚îú‚îÄ‚îÄ Hero Section
‚îÇ   ‚îú‚îÄ‚îÄ Features Showcase
‚îÇ   ‚îú‚îÄ‚îÄ How It Works
‚îÇ   ‚îú‚îÄ‚îÄ Download Links
‚îÇ   ‚îî‚îÄ‚îÄ Footer
‚îú‚îÄ‚îÄ /upload (Upload Page)
‚îÇ   ‚îú‚îÄ‚îÄ Drag & Drop Zone
‚îÇ   ‚îú‚îÄ‚îÄ EXIF GPS Extraction
‚îÇ   ‚îú‚îÄ‚îÄ Manual GPS Input (Map Picker)
‚îÇ   ‚îú‚îÄ‚îÄ Watermark Preview
‚îÇ   ‚îî‚îÄ‚îÄ Upload Progress
‚îú‚îÄ‚îÄ /gallery (User Gallery)
‚îÇ   ‚îú‚îÄ‚îÄ Photo Grid
‚îÇ   ‚îú‚îÄ‚îÄ Filters (date, location)
‚îÇ   ‚îî‚îÄ‚îÄ Export Options
‚îú‚îÄ‚îÄ /map (Map View)
‚îÇ   ‚îú‚îÄ‚îÄ Interactive Map
‚îÇ   ‚îú‚îÄ‚îÄ Photo Markers
‚îÇ   ‚îî‚îÄ‚îÄ Clustering
‚îú‚îÄ‚îÄ /p/[id] (Public Link Viewer)
‚îÇ   ‚îú‚îÄ‚îÄ Photo Display
‚îÇ   ‚îú‚îÄ‚îÄ Mini Map
‚îÇ   ‚îú‚îÄ‚îÄ Metadata Panel
‚îÇ   ‚îî‚îÄ‚îÄ Share Buttons
‚îî‚îÄ‚îÄ /privacy, /terms, /about
```

### Upload Implementation (Web):

```typescript
// app/upload/page.tsx
'use client';

import { useDropzone } from 'react-dropzone';
import exifr from 'exifr';

const UploadPage = () => {
  const onDrop = async (files: File[]) => {
    for (const file of files) {
      // Extract EXIF GPS data
      const exif = await exifr.parse(file);

      let gps = null;
      if (exif?.latitude && exif?.longitude) {
        gps = {
          lat: exif.latitude,
          lon: exif.longitude,
          altitude: exif.altitude,
        };
      } else {
        // Show map picker for manual GPS input
        gps = await showMapPicker();
      }

      // Generate thumbnail client-side
      const thumbnail = await generateWebThumbnail(file);

      // Get device fingerprint
      const deviceId = getWebDeviceId();

      // Upload
      await uploadToServer({
        photo: file,
        thumbnail,
        gps,
        deviceId,
        metadata: {
          userAgent: navigator.userAgent,
          language: navigator.language,
          timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        },
      });
    }
  };

  const { getRootProps, getInputProps, isDragActive } = useDropzone({
    onDrop,
    accept: { 'image/*': ['.jpg', '.jpeg', '.png'] },
    maxSize: 10 * 1024 * 1024, // 10MB
  });

  return (
    <div {...getRootProps()} className="upload-zone">
      <input {...getInputProps()} />
      {isDragActive ? (
        <p>Drop photos here...</p>
      ) : (
        <p>Drag photos or click to select</p>
      )}
    </div>
  );
};
```

### PWA Configuration:

```javascript
// next.config.js
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
  disable: process.env.NODE_ENV === 'development',
});

module.exports = withPWA({
  // Next.js config
});
```

```json
// public/manifest.json
{
  "name": "GeoMark ‚Äî GPS Camera",
  "short_name": "GeoMark",
  "description": "GPS Camera App with Location Tracking",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#00796B",
  "theme_color": "#00796B",
  "icons": [
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

### Design System (shadcn/ui + Tailwind):

```typescript
// components/ui/button.tsx
import { cn } from '@/lib/utils';

const Button = ({ className, variant = 'default', ...props }) => {
  return (
    <button
      className={cn(
        'rounded-xl px-4 py-2 font-medium transition-all',
        'hover:shadow-lg active:scale-95',
        variant === 'primary' && 'bg-teal-700 text-white',
        variant === 'secondary' && 'bg-amber-600 text-white',
        className
      )}
      {...props}
    />
  );
};
```

---

## ‚öôÔ∏è Backend API ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### API Endpoints:

```typescript
// Photo Upload
POST /api/photos/upload
Content-Type: multipart/form-data
Body: {
  photo: File,
  thumbnail: File,
  gps: { lat, lon, altitude, accuracy },
  deviceId: string,
  metadata: {
    ip: string (auto),
    userAgent: string,
    deviceModel: string,
    osVersion: string,
  },
  retentionPeriod: '1h' | '24h' | '7d' | 'forever',
}
Response: {
  id: string,
  publicUrl: string,
  scheduledDeletion: Date,
}

// Get Photo by ID
GET /api/photos/:id
Response: {
  id: string,
  url: string,
  thumbnailUrl: string,
  gps: { lat, lon, altitude, accuracy },
  address: string,
  timestamp: Date,
  viewCount: number,
}

// Delete Photo
DELETE /api/photos/:id
Headers: { X-Device-ID: string }
Response: { success: true }

// Gallery (Paginated)
GET /api/photos?device_id=xxx&page=1&limit=20
Response: {
  photos: Photo[],
  total: number,
  hasMore: boolean,
}
```

### Database Schema (PostgreSQL + PostGIS):

```sql
-- Enable PostGIS extension
CREATE EXTENSION IF NOT EXISTS postgis;

-- Photos table
CREATE TABLE photos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  device_id VARCHAR(255) NOT NULL,
  ip_address INET NOT NULL,
  ip_country VARCHAR(2),
  ip_city VARCHAR(100),

  -- Photo files
  photo_url TEXT,
  thumbnail_url TEXT,

  -- GPS data (PostGIS)
  location GEOGRAPHY(POINT, 4326),
  latitude DOUBLE PRECISION,
  longitude DOUBLE PRECISION,
  altitude DOUBLE PRECISION,
  accuracy DOUBLE PRECISION,

  -- Geocoding
  address TEXT,

  -- Metadata
  device_model VARCHAR(100),
  os_version VARCHAR(50),
  app_version VARCHAR(20),
  user_agent TEXT,
  photo_size INTEGER,
  dimensions VARCHAR(20),
  format VARCHAR(10),

  -- Timestamps
  created_at TIMESTAMP DEFAULT NOW(),
  uploaded_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP,
  scheduled_deletion TIMESTAMP,
  retention_period VARCHAR(10),

  -- Moderation
  flagged BOOLEAN DEFAULT FALSE,
  suspicious_pattern BOOLEAN DEFAULT FALSE,

  -- Stats
  view_count INTEGER DEFAULT 0,

  -- Indexes
  INDEX idx_device_id (device_id),
  INDEX idx_ip_address (ip_address),
  INDEX idx_created_at (created_at DESC),
  INDEX idx_location USING GIST (location),
  INDEX idx_scheduled_deletion (scheduled_deletion) WHERE deleted_at IS NULL
);

-- Metadata retention table (after photo deletion)
CREATE TABLE photo_metadata (
  id UUID PRIMARY KEY,
  photo_id UUID REFERENCES photos(id),
  device_id VARCHAR(255),
  ip_address_hash VARCHAR(64), -- SHA256 hash after 90 days
  location GEOGRAPHY(POINT, 4326),
  timestamp TIMESTAMP,
  retention_until TIMESTAMP, -- 90 days from deletion

  INDEX idx_retention (retention_until)
);
```

### Location Pattern Detection:

```typescript
// services/pattern-detection.service.ts
class PatternDetectionService {
  async checkSuspiciousPatterns(upload: PhotoUpload): Promise<boolean> {
    // 1. Same location check (radius 50m)
    const nearbyPhotos = await this.db.query(`
      SELECT COUNT(*) as count
      FROM photos
      WHERE device_id = $1
        AND ST_DWithin(
          location,
          ST_MakePoint($2, $3)::geography,
          50 -- 50 meters
        )
        AND created_at > NOW() - INTERVAL '24 hours'
    `, [upload.deviceId, upload.longitude, upload.latitude]);

    if (nearbyPhotos.count > 5) {
      return true; // Suspicious: 5+ uploads in same spot
    }

    // 2. Regular intervals check (every 30 min)
    const recentUploads = await this.getRecentUploads(upload.deviceId, 24);
    const intervals = this.calculateIntervals(recentUploads);
    const regularInterval = intervals.every(i => Math.abs(i - 1800) < 300); // ¬±5 min

    if (regularInterval && recentUploads.length > 10) {
      return true; // Suspicious: automated uploads
    }

    // 3. Night activity (00:00-06:00)
    const hour = new Date(upload.timestamp).getHours();
    if (hour >= 0 && hour < 6) {
      const nightUploads = await this.getNightUploads(upload.deviceId, 7);
      if (nightUploads.length > 10) {
        return true; // Suspicious: frequent night activity
      }
    }

    // 4. Route detection (city-to-city)
    const route = await this.detectRoute(upload.deviceId, 24);
    if (route.cities.length > 3 && route.totalDistance > 500000) { // 500km
      return true; // Suspicious: long-distance route
    }

    return false;
  }
}
```

### Telegram Bot Integration:

```typescript
// services/telegram-bot.service.ts
import TelegramBot from 'node-telegram-bot-api';

class TelegramModerationService {
  private bot: TelegramBot;

  async sendToChannel(photo: Photo, suspicious: boolean) {
    const region = this.determineRegion(photo.latitude, photo.longitude);
    const channelId = this.getChannelId(suspicious ? 'suspicious' : region);

    // Get geocoded address
    const address = await this.geocode(photo.latitude, photo.longitude);

    const message = `
üì∏ New Upload
üìç ${address}
üåê ${photo.latitude.toFixed(6)}, ${photo.longitude.toFixed(6)}
‚ö° Accuracy: ${photo.accuracy}m
üîó https://geomark.app/p/${photo.id}

üì± Device: ${photo.deviceModel}
üåç IP: ${photo.ipCity}, ${photo.ipCountry}
üïí ${new Date(photo.timestamp).toLocaleString('ru-RU')}

${suspicious ? '‚ö†Ô∏è SUSPICIOUS PATTERN DETECTED' : ''}
    `.trim();

    // Send thumbnail (not full 10MB photo)
    await this.bot.sendPhoto(channelId, photo.thumbnailUrl, {
      caption: message,
      parse_mode: 'HTML',
    });
  }

  determineRegion(lat: number, lon: number): string {
    // Moscow region
    if (lat >= 55.142 && lat <= 56.577 && lon >= 36.803 && lon <= 39.185) {
      return 'moscow';
    }

    // St. Petersburg region
    if (lat >= 59.444 && lat <= 60.5 && lon >= 29.5 && lon <= 31.0) {
      return 'spb';
    }

    // Russia other (check country code)
    if (this.isRussia(lat, lon)) {
      return 'russia_other';
    }

    return 'foreign';
  }
}
```

### Auto-deletion Cron Job:

```typescript
// services/auto-deletion.service.ts
import { Cron, CronExpression } from '@nestjs/schedule';

class AutoDeletionService {
  @Cron(CronExpression.EVERY_10_MINUTES)
  async deleteExpiredPhotos() {
    const expired = await this.db.photos.findMany({
      where: {
        scheduled_deletion: { lte: new Date() },
        deleted_at: null,
      },
    });

    for (const photo of expired) {
      // Delete from Cloudflare R2
      await this.r2.deleteObject({
        Bucket: process.env.R2_BUCKET,
        Key: photo.photo_url,
      });

      await this.r2.deleteObject({
        Bucket: process.env.R2_BUCKET,
        Key: photo.thumbnail_url,
      });

      // Update DB (keep metadata!)
      await this.db.photos.update({
        where: { id: photo.id },
        data: {
          photo_url: null,
          thumbnail_url: null,
          deleted_at: new Date(),
        },
      });

      // Create metadata retention record
      await this.db.photoMetadata.create({
        data: {
          photo_id: photo.id,
          device_id: photo.device_id,
          ip_address_hash: photo.ip_address, // Will be hashed after 90 days
          location: photo.location,
          timestamp: photo.created_at,
          retention_until: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000),
        },
      });

      console.log(`Deleted photo ${photo.id}, metadata retained`);
    }
  }

  @Cron(CronExpression.EVERY_DAY_AT_MIDNIGHT)
  async anonymizeOldMetadata() {
    const crypto = require('crypto');

    const toAnonymize = await this.db.photoMetadata.findMany({
      where: {
        retention_until: { lte: new Date() },
        ip_address_hash: { contains: '.' }, // Not yet hashed
      },
    });

    for (const metadata of toAnonymize) {
      const hashed = crypto
        .createHash('sha256')
        .update(metadata.ip_address_hash)
        .digest('hex');

      await this.db.photoMetadata.update({
        where: { id: metadata.id },
        data: {
          ip_address_hash: hashed,
          device_id: null, // Remove device ID
        },
      });
    }

    console.log(`Anonymized ${toAnonymize.length} metadata records`);
  }
}
```

---

## üìÖ –î–µ—Ç–∞–ª—å–Ω–∞—è Roadmap (12 –Ω–µ–¥–µ–ª—å –¥–æ MVP)

### **Phase 1: Foundation (Week 1-3)**

#### Week 1: Project Setup & Design
- [ ] Initialize Git mono-repo (Turborepo)
- [ ] Setup development environments
- [ ] Create Figma design system
- [ ] Design all mobile screens (Material Design 3)
- [ ] Design website pages (Tailwind)
- [ ] Create brand assets (logo, icons, splash screens)

**Deliverable:** –ü–æ–ª–Ω—ã–π –¥–∏–∑–∞–π–Ω –≤ Figma, –≥–æ—Ç–æ–≤—ã–π –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

#### Week 2: Backend Foundation
- [ ] NestJS project setup
- [ ] PostgreSQL + PostGIS database
- [ ] Cloudflare R2 integration
- [ ] Photo upload endpoint (multipart)
- [ ] Device fingerprinting logic
- [ ] Rate limiting middleware

**Deliverable:** Working API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ

#### Week 3: Telegram Bot & Moderation
- [ ] Telegram Bot setup (5 –∫–∞–Ω–∞–ª–æ–≤)
- [ ] Region detection (PostGIS spatial queries)
- [ ] Location pattern detection logic
- [ ] Geocoding service (Nominatim + Google fallback)
- [ ] Thumbnail generation (Sharp)
- [ ] Auto-deletion cron job

**Deliverable:** –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### **Phase 2: Mobile App (Week 4-7)**

#### Week 4: Camera & GPS
- [ ] React Native 0.74 project (EAS)
- [ ] VisionCamera 4.x integration
- [ ] GPS tracking —Å motion detection
- [ ] EXIF metadata writing
- [ ] Watermark overlay (real-time preview)
- [ ] Local storage (WatermelonDB)

**Deliverable:** –†–∞–±–æ—á–∞—è –∫–∞–º–µ—Ä–∞ —Å GPS

#### Week 5: Gallery & Map
- [ ] Gallery screen (grid view)
- [ ] Photo detail screen
- [ ] Map integration (react-native-maps)
- [ ] Markers clustering
- [ ] Bottom sheet photo preview
- [ ] Filters (date, location)

**Deliverable:** –ü–æ–ª–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

#### Week 6: Upload & Sync
- [ ] Upload to server API
- [ ] Thumbnail generation (client-side)
- [ ] Offline queue (background sync)
- [ ] Retry logic (exponential backoff)
- [ ] Progress indicators
- [ ] Error handling

**Deliverable:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å backend

#### Week 7: Settings & Polish
- [ ] Settings screen
- [ ] Auto-deletion timer picker
- [ ] Theme switcher (light/dark)
- [ ] Privacy Policy screen
- [ ] Onboarding flow
- [ ] Material Design 3 components finalize

**Deliverable:** MVP mobile app –≥–æ—Ç–æ–≤

---

### **Phase 3: Website (Week 8-10)**

#### Week 8: Core Pages
- [ ] Next.js 15 project setup
- [ ] Landing page (hero, features, download)
- [ ] Upload page (drag & drop)
- [ ] EXIF extraction (exifr)
- [ ] Manual GPS picker (map)
- [ ] PWA configuration

**Deliverable:** Working upload —á–µ—Ä–µ–∑ —Å–∞–π—Ç

#### Week 9: Gallery & Viewer
- [ ] Gallery page (photo grid)
- [ ] Map view (Mapbox)
- [ ] Public link viewer (/p/[id])
- [ ] Metadata panel
- [ ] Share buttons
- [ ] Responsive design (mobile/tablet/desktop)

**Deliverable:** –ü–æ–ª–Ω—ã–π –≤–µ–±-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

#### Week 10: Design & UX
- [ ] shadcn/ui components
- [ ] Tailwind CSS styling
- [ ] Dark mode
- [ ] Animations (Framer Motion)
- [ ] Loading states
- [ ] Error pages

**Deliverable:** –ö—Ä–∞—Å–∏–≤—ã–π —Å–∞–π—Ç –≥–æ—Ç–æ–≤

---

### **Phase 4: Testing & Release (Week 11-12)**

#### Week 11: Testing
- [ ] Unit tests (Jest)
- [ ] Integration tests (backend API)
- [ ] E2E tests mobile (Detox)
- [ ] E2E tests web (Playwright)
- [ ] GPS accuracy testing (field tests)
- [ ] Offline mode testing
- [ ] Performance testing (Lighthouse)
- [ ] Security audit

**Deliverable:** –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

#### Week 12: Release Preparation
- [ ] App Store assets (screenshots, description)
- [ ] Google Play assets (screenshots, description)
- [ ] Privacy Policy —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] Terms of Service
- [ ] App Store submission (iOS)
- [ ] Google Play submission (Android)
- [ ] Website deployment (Vercel)
- [ ] Monitoring setup (Sentry, Datadog)

**Deliverable:** üöÄ LIVE!

---

## üìã Google Play Checklist

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:

#### 1. **App Content**
- [ ] App name: "GeoMark - GPS Camera"
- [ ] Short description (80 chars)
- [ ] Full description (4000 chars)
- [ ] Screenshots (–º–∏–Ω–∏–º—É–º 2, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8)
  - Phone: 1080x1920 –∏–ª–∏ 1080x2400
  - Tablet: 1600x2560 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Feature Graphic: 1024x500
- [ ] App Icon: 512x512 (32-bit PNG)

#### 2. **Privacy & Compliance**
- [ ] Privacy Policy URL (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- [ ] Data Safety form –∑–∞–ø–æ–ª–Ω–µ–Ω:
  - –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞–µ–º: GPS, IP, device ID
  - –ó–∞—á–µ–º: Security, pattern detection
  - –ö–∞–∫ —Ö—Ä–∞–Ω–∏–º: Encrypted, auto-delete
  - Sharing: –ù–µ –ø–µ—Ä–µ–¥–∞—ë–º —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º
- [ ] Target age: 18+ (–∏–∑-–∑–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞)
- [ ] Content rating –∑–∞–ø–æ–ª–Ω–µ–Ω

#### 3. **Permissions Justification**
- [ ] Location (ACCESS_FINE_LOCATION) ‚Äî –¥–ª—è GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- [ ] Camera ‚Äî –¥–ª—è —Ñ–æ—Ç–æ
- [ ] Storage ‚Äî –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- [ ] Internet ‚Äî –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–í–∞–∂–Ω–æ:** –û–ø–∏—Å–∞—Ç—å –≤ Privacy Policy –ó–ê–ß–ï–ú –Ω—É–∂–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è!

#### 4. **App Bundle**
- [ ] AAB (Android App Bundle) —Ñ–æ—Ä–º–∞—Ç
- [ ] –ü–æ–¥–ø–∏—Å–∞–Ω release key
- [ ] ProGuard/R8 –≤–∫–ª—é—á–µ–Ω (–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è)
- [ ] Size < 150MB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è < 50MB)

#### 5. **Testing**
- [ ] Internal testing track (–∑–∞–∫—Ä—ã—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [ ] Open testing (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Production release

---

## üí∞ –ë—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞

### Infrastructure (–º–µ—Å—è—Ü):

| –°–µ—Ä–≤–∏—Å | –°—Ç–æ–∏–º–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|----------|
| **Backend Hosting** | $20-40 | Railway/Render (1-2 instances) |
| **Database** | $15-25 | PostgreSQL managed (Supabase/Neon) |
| **Storage (R2)** | $5-15 | 100GB + bandwidth |
| **Geocoding API** | $0-10 | Nominatim (free) + Google fallback |
| **Monitoring** | $0-10 | Sentry free tier |
| **Domain** | $1 | geomark.app |
| **Website Hosting** | $0 | Vercel free tier |
| **Total** | **$41-101/–º–µ—Å** | |

### Development (—Ä–∞–∑–æ–≤—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã):

| –£—Å–ª—É–≥–∞ | –°—Ç–æ–∏–º–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|----------|
| **Figma/Design** | $0 | Free tier (—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ) |
| **Apple Developer** | $99/–≥–æ–¥ | App Store account |
| **Google Play** | $25 | One-time fee |
| **Total** | **$124** | |

---

## üéØ Success Metrics (KPIs)

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ:
- ‚úÖ App size < 40MB
- ‚úÖ Launch time < 2 sec
- ‚úÖ GPS accuracy < 10m (outdoor)
- ‚úÖ Battery drain < 2%/day
- ‚úÖ Crash rate < 1%
- ‚úÖ Upload success rate > 95%

### –ë–∏–∑–Ω–µ—Å (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü):
- ‚úÖ 1,000+ —É—Å—Ç–∞–Ω–æ–≤–æ–∫
- ‚úÖ 4.0+ rating
- ‚úÖ 20%+ retention (7 days)
- ‚úÖ 50+ daily active users

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ Location pattern detection —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Zero data breaches
- ‚úÖ Privacy compliance (GDPR + –†–§)

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **Week 1 Start:**
   - –°–æ–∑–¥–∞—Ç—å Figma workspace
   - Setup Git mono-repo (Turborepo)
   - –ù–∞—á–∞—Ç—å –¥–∏–∑–∞–π–Ω –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

2. **Parallel Work:**
   - –î–∏–∑–∞–π–Ω–µ—Ä: Figma mockups (Week 1-2)
   - Backend Dev: NestJS API (Week 2-3)
   - Frontend Dev: React Native setup (Week 4+)

3. **Communication:**
   - Daily standups (15 –º–∏–Ω)
   - Weekly demo (–ø—è—Ç–Ω–∏—Ü–∞)
   - Slack/Discord –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

---

**–ì–æ—Ç–æ–≤ –∫ —Å—Ç–∞—Ä—Ç—É!** üéâ

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [PRD.md](./PRD.md) ‚Äî Product requirements
- [MODERATION.md](./MODERATION.md) ‚Äî Moderation system
- [SECURITY_PRIVACY.md](./SECURITY_PRIVACY.md) ‚Äî Privacy policy
- [WEBSITE_SPEC.md](./WEBSITE_SPEC.md) ‚Äî Website specification
- [CRITICAL_CHANGES_v2.md](./CRITICAL_CHANGES_v2.md) ‚Äî Changelog

---

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- [NoteCam Lite on Google Play](https://play.google.com/store/apps/details?id=com.derekr.NoteCam)
- [Mobile App Design Trends 2026](https://uxpilot.ai/blogs/mobile-app-design-trends)
- [React Native Best Practices 2026](https://medium.com/@lucina12/react-native-in-2026-advanced-patterns-best-practices-future-proof-development-6a9982c3f580)
- [VisionCamera GPS Integration](https://react-native-vision-camera.com/docs/guides/location)
